<!DOCTYPE html>
<html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <link rel="icon" href="/favicon.ico">
  
  <title>鱿鱼由于有雨忧郁 | react 的ES5和ES6写法对比</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox-1.3.4.css">
  <!--在这里倒入jquery 方便处理部分页面的jquery-->
  <script src="https://cdn.staticfile.org/jquery/1.7/jquery.min.js" type="text/javascript"></script>
</head></html>

<body>
	<header class="site-header navfixed-false">
  <div class="container">
      <h1><a href="/" title="鱿鱼由于有雨忧郁"><span class="octicon octicon-mark-github"></span> 鱿鱼由于有雨忧郁</a></h1>
      <nav class="site-header-nav" role="navigation">
        
              
              <a href="/" class=" site-header-nav-item hvr-underline-from-center" title="首页">首页</a>
        
              
              <a href="/categories/" class=" site-header-nav-item hvr-underline-from-center" title="分类">分类</a>
        
              
              <a href="/open-source/" class=" site-header-nav-item hvr-underline-from-center" title="开源项目">开源项目</a>
        
      </nav>
  </div>
</header>

	
<section class="collection-head geopattern lll" data-pattern-id="react 的ES5和ES6写法对比">
    <div class="container">
        <div class="collection-title">
            <h1 class="collection-header">
                react 的ES5和ES6写法对比
            </h1>
            
                <div class="collection-info">
                    <span class="meta-info">
                        <span class="octicon octicon-calendar"></span>
                        <time datetime="2016-02-14T09:08:23.000Z" itemprop="datePublished">2016-02-14</time>
                    </span>
                    
                        <span class="meta-info">
                            <span class="octicon octicon-file-directory"></span>
                            <a href="/categories/javascript/" title>javascript</a>
                        </span>
                    
                </div>
            
        </div>
    </div>
</section>
	<section class="container">
    <div class="columns">
        <div class="column three-fourths">
            <article class="article-content markdown-body">
                <p>在javascript正式进入ES6时代后，react的语法也与时俱进的进行了大革新。这让很多初学者出现对ES6的困惑，今天在此整理了一些ES5和ES6的写法对照表，互相学习共勉。<br><a id="more"></a></p>
<h3 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h3><blockquote>
<p>引用</p>
</blockquote>
<p>在ES5里，如果使用CommonJS标准，引入React包基本通过require进行，代码类似这样：</p>
<pre><code class="javascript">var React = require(&quot;react-native&quot;);
var {
    Image,
    Text,
    PropTypes
} = React;  //引用不同的React Native组件
</code></pre>
<p>在ES6里，import写法更为标准</p>
<pre><code class="javascript">import React, {
    Image,
    Text,
    PropTypes
} from &#39;react-native&#39;;
</code></pre>
<p><div class="tip"><br>    注意在React Native里，import直到0.12+才能正常运作。<br></div></p>
<blockquote>
<p>导出单个类</p>
</blockquote>
<p>在ES5里，要导出一个类给别的模块用，一般通过module.exports来导出</p>
<pre><code class="javascript">//ES5
var MyComponent = React.createClass({
    ...
});
module.exports = MyComponent;
</code></pre>
<p>在ES6里，通常用export default来实现相同的功能：</p>
<pre><code class="javascript">//ES6
export default class MyComponent extends React.Component{
    ...
}
</code></pre>
<p>引用的时候也类似：</p>
<pre><code class="javascript">//ES5
var MyComponent = require(&#39;./MyComponent.js&#39;);

//ES6
import MyComponent from &#39;./MyComponent.js&#39;;
</code></pre>
<h3 id="定义组件"><a href="#定义组件" class="headerlink" title="定义组件"></a>定义组件</h3><p>在ES5里，通常通过React.createClass来定义一个组件类，像这样：</p>
<pre><code class="javascript">//ES5
var Photo = React.createClass({
    render: function() {
        return (
            &lt;Image source={this.props.source} /&gt;
        );
    },
});
</code></pre>
<p>在ES6里，我们通过定义一个继承自React.Component的class来定义一个组件类，像这样：</p>
<pre><code class="javascript">//ES6
class Photo extends React.Component {
    render() {
        return (
            &lt;Image source={this.props.source} /&gt;
        );
    }
}
</code></pre>
<blockquote>
<p>给组件定义方法</p>
</blockquote>
<p>从上面的例子里可以看到，给组件定义方法不再用 名字: function()的写法，而是直接用名字()，在方法的最后也不能有逗号了。</p>
<pre><code class="javascript">//ES5
var Photo = React.createClass({
    componentWillMount: function(){

    },
    render: function() {
        return (
            &lt;Image source={this.props.source} /&gt;
        );
    },
});
//ES6
class Photo extends React.Component {
    componentWillMount() {

    }
    render() {
        return (
            &lt;Image source={this.props.source} /&gt;
        );
    }
}
</code></pre>
<blockquote>
<p>定义组件的属性类型和默认属性</p>
</blockquote>
<p>在ES5里，属性类型和默认属性分别通过propTypes成员和getDefaultProps方法来实现</p>
<pre><code class="javascript">//ES5
var Video = React.createClass({
    getDefaultProps: function() {
        return {
            autoPlay: false,
            maxLoops: 10,
        };
    },
    propTypes: {
        autoPlay: React.PropTypes.bool.isRequired,
        maxLoops: React.PropTypes.number.isRequired,
        posterFrameSrc: React.PropTypes.string.isRequired,
        videoSrc: React.PropTypes.string.isRequired,
    },
    render: function() {
        return (
            &lt;View /&gt;
        );
    },
});
</code></pre>
<p>在ES6里，可以统一使用static成员来实现</p>
<pre><code class="javascript">//ES6
class Video extends React.Component {
    static defaultProps = {
        autoPlay: false,
        maxLoops: 10,
    };  // 注意这里有分号
    static propTypes = {
        autoPlay: React.PropTypes.bool.isRequired,
        maxLoops: React.PropTypes.number.isRequired,
        posterFrameSrc: React.PropTypes.string.isRequired,
        videoSrc: React.PropTypes.string.isRequired,
    };  // 注意这里有分号
    render() {
        return (
            &lt;View /&gt;
        );
    } // 注意这里既没有分号也没有逗号
}
</code></pre>
<blockquote>
<p>初始化STATE</p>
</blockquote>
<p>ES5下情况类似，</p>
<pre><code class="javascript">//ES5
var Video = React.createClass({
    getInitialState: function() {
        return {
            loopsRemaining: this.props.maxLoops,
        };
    },
})
</code></pre>
<p>ES6下，有两种写法：</p>
<pre><code class="javascript">//ES6
class Video extends React.Component {
    state = {
        loopsRemaining: this.props.maxLoops,
    }
}
</code></pre>
<p>不过我们推荐更易理解的在构造函数中初始化（这样你还可以根据需要做一些计算）：</p>
<pre><code class="javascript">//ES6
class Video extends React.Component {
    constructor(props){
        super(props);
        this.state = {
            loopsRemaining: this.props.maxLoops,
        };
    }
}
</code></pre>
<blockquote>
<p>把方法作为回调提供</p>
</blockquote>
<p>很多习惯于ES6的用户反而不理解在ES5下可以这么做：</p>
<pre><code class="javascript">//ES5
var PostInfo = React.createClass({
    handleOptionsButtonClick: function(e) {
        // Here, &#39;this&#39; refers to the component instance.
        this.setState({showOptionsModal: true});
    },
    render: function(){
        return (
            &lt;TouchableHighlight onPress={this.handleOptionsButtonClick}&gt;
                &lt;Text&gt;{this.props.label}&lt;/Text&gt;
            &lt;/TouchableHighlight&gt;
        )
    },
});
</code></pre>
<p>在ES5下，React.createClass会把所有的方法都bind一遍，这样可以提交到任意的地方作为回调函数，而this不会变化。但官方现在逐步认为这反而是不标准、不易理解的。<br>在ES6下，你需要通过bind来绑定this引用，或者使用箭头函数（它会绑定当前scope的this引用）来调用</p>
<pre><code class="javascript">//ES6
class PostInfo extends React.Component
{
    handleOptionsButtonClick(e){
        this.setState({showOptionsModal: true});
    }
    render(){
        return (
            &lt;TouchableHighlight
                onPress={this.handleOptionsButtonClick.bind(this)}
                onPress={e=&gt;this.handleOptionsButtonClick(e)}
                &gt;
                &lt;Text&gt;{this.props.label}&lt;/Text&gt;
            &lt;/TouchableHighlight&gt;
        )
    },
}
</code></pre>
<p>箭头函数实际上是在这里定义了一个临时的函数，箭头函数的箭头=&gt;之前是一个空括号、单个的参数名、或用括号括起的多个参数名，而箭头之后可以是一个表达式（作为函数的返回值），或者是用花括号括起的函数体（需要自行通过return来返回值，否则返回的是undefined）。</p>
<pre><code class="javascript">// 箭头函数的例子
()=&gt;1
v=&gt;v+1
(a,b)=&gt;a+b
()=&gt;{
    alert(&quot;foo&quot;);
}
e=&gt;{
    if (e == 0){
        return 0;
    }
    return 1000/e;
}
</code></pre>
<p>需要注意的是，不论是bind还是箭头函数，每次被执行都返回的是一个新的函数引用，因此如果你还需要函数的引用去做一些别的事情（譬如卸载监听器），那么你必须自己保存这个引用</p>
<pre><code class="javascript">// 错误的做法
class PauseMenu extends React.Component{
    componentWillMount(){
        AppStateIOS.addEventListener(&#39;change&#39;, this.onAppPaused.bind(this));
    }
    componentDidUnmount(){
        AppStateIOS.removeEventListener(&#39;change&#39;, this.onAppPaused.bind(this));
    }
    onAppPaused(event){
    }
}
// 正确的做法
class PauseMenu extends React.Component{
    constructor(props){
        super(props);
        this._onAppPaused = this.onAppPaused.bind(this);
    }
    componentWillMount(){
        AppStateIOS.addEventListener(&#39;change&#39;, this._onAppPaused);
    }
    componentDidUnmount(){
        AppStateIOS.removeEventListener(&#39;change&#39;, this._onAppPaused);
    }
    onAppPaused(event){
    }
}
</code></pre>
<p>从上面我们还学习到一种新的做法：</p>
<pre><code class="javascript">// 正确的做法
class PauseMenu extends React.Component{
    componentWillMount(){
        AppStateIOS.addEventListener(&#39;change&#39;, this.onAppPaused);
    }
    componentDidUnmount(){
        AppStateIOS.removeEventListener(&#39;change&#39;, this.onAppPaused);
    }
    onAppPaused = (event) =&gt; {
        //把方法直接作为一个arrow function的属性来定义，初始化的时候就绑定好了this指针
    }
}
</code></pre>
<h3 id="ES6带来的其它好处"><a href="#ES6带来的其它好处" class="headerlink" title="ES6带来的其它好处"></a>ES6带来的其它好处</h3><blockquote>
<p>解构&amp;属性延展</p>
</blockquote>
<p>结合使用ES6+的解构和属性延展，我们给孩子传递一批属性更为方便了。这个例子把className以外的所有属性传递给div标签：</p>
<pre><code class="javascript">class AutoloadingPostsGrid extends React.Component {
    render() {
        var {
            className,
            ...others,  // contains all properties of this.props except for className
        } = this.props;
        return (
            &lt;div className={className}&gt;
                &lt;PostsGrid {...others} /&gt;
                &lt;button onClick={this.handleLoadMoreClick}&gt;Load more&lt;/button&gt;
            &lt;/div&gt;
        );
    }
}
</code></pre>
<p>下面这种写法，则是传递所有属性的同时，用覆盖新的className值：</p>
<pre><code class="javascript">&lt;div {...this.props} className=&quot;override&quot;&gt;
    …
&lt;/div&gt;
</code></pre>
<p>这个例子则相反，如果属性中没有包含className，则提供默认的值，而如果属性中已经包含了，则使用属性中的值</p>
<pre><code class="javascript">&lt;div className=&quot;base&quot; {...this.props}&gt;
    …
&lt;/div&gt;
</code></pre>

            </article>
            
                <div class="share">
                    <!--开启分享-->
<div class="share-component" data-disabled="google,twitter,facebook" data-description="在javascript正式进入ES6时代后，react..."></div>

<script src="/js/share.min.js"></script>

                </div>    
            

            
            
                
                    
<div class="comments">
	<div class="ds-thread" data-thread-key="react-的ES5和ES6写法对比" data-title="react 的ES5和ES6写法对比" data-url="http://tinjian.com/2016/02/14/react-的ES5和ES6写法对比/"></div>
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"yumemor"};
		(function() {
			var ds = document.createElement('script');
			ds.type = 'text/javascript';ds.async = true;
			ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
			ds.charset = 'UTF-8';
			(document.getElementsByTagName('head')[0]
			 || document.getElementsByTagName('body')[0]).appendChild(ds);
		})();
	</script>
</div>

                
            

        </div>
        <div class="column one-fourth">
            
                
                


<h3>Post Directory</h3>

<div id="post-directory-module">
	<section class="post-directory">
		<p><strong class="toc-title">文章目录</strong></p>
		<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#模块"><span class="toc-text">模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#定义组件"><span class="toc-text">定义组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ES6带来的其它好处"><span class="toc-text">ES6带来的其它好处</span></a></li></ol>
	</section>
</div>
            
        </div>
    </div>
</section>
</body>
<footer class="container">
    <div class="site-footer" role="contentinfo">
        <div class="copyright left mobile-block">
                © 2016
                <span title="yumemor">wushain</span>
                <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a>
        </div>

        <ul class="site-footer-links right mobile-hidden">
            <li>
                <a href="javascript:window.scrollTo(0,0)">TOP</a>
            </li>
        </ul>

        <a href="https://github.com/zx1988826" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a>

        <ul class="site-footer-links mobile-hidden">
            
                  
                  <li>
                    <a href="/" title="首页">首页</a>
                  </li>
            
                  
                  <li>
                    <a href="/categories/" title="分类">分类</a>
                  </li>
            
                  
                  <li>
                    <a href="/open-source/" title="开源项目">开源项目</a>
                  </li>
            
            <li>
                <a href="/atom.xml">
                    <span class="octicon octicon-rss" style="color:orange;"></span>
                </a>
            </li>
        </ul>
    </div>
</footer>

		<script src="/js/geopattern.js"></script>
		<script src="/js/highlight.pack.js"></script>
		<script src="/lib/fancybox/jquery.fancybox-1.3.4.pack.js"></script>

		
			<script src="/js/toc.js"></script>
		

		
			<script src="/js/search.js"></script>

			<script type="text/javascript">
				$(function(){
					var currentIndex = -1;
					var search_path = "search.xml";
					if (!search_path) search_path = "search.xml";
					var path = "/" + search_path;
					searchFunc(path, 'search', 'local-search-result');

					$(document).delegate("#local-search-result>.search-result-list li","hover",function(){
						var liNode = $("#local-search-result>.search-result-list li");
						liNode.removeClass("hover");
						currentIndex = $("#local-search-result>.search-result-list li").index($(this));
						liNode.eq(currentIndex).addClass("hover");
					})

					$("#search-form").submit(function(){
						return false;
					})

					$("#search").keydown(function(event){
						var keyCode = event.keyCode;
						var liNode = $("#local-search-result>.search-result-list li");
						if(keyCode == 38 || keyCode == 40 || keyCode == 13){
							liNode.removeClass("hover");
							if(keyCode == 38){
								if(currentIndex - 1 >= 0) currentIndex --;
							}
							if(keyCode == 40){
								if(currentIndex + 1 < liNode.length) currentIndex ++;
							}
							if(keyCode == 13){
								location.href = liNode.eq(currentIndex).find("a").attr("href");
							}
							liNode.eq(currentIndex).addClass("hover");
							return false;
						}else{
							currentIndex = -1;
						}
					})
				})
			</script>
		

		<script src="/js/index.js"></script>

		 <script src="/js/popular_repo.js"></script> 

	
